<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>身份证</title></head>
<body><h3>1. 开发包说明</h3>
<p>   1.1 支持读中国大陆的二代身份证和三带身份证;</p>
<p>   1.2 身份证功能占用了/dev/ttyHSL1串口，波特率115200,需要依赖<a href='https://fcrbuw.coding.io/?p=24'>串口开发包</a>;</p>
<p>   1.3 身份证开发包兼容机器请查看:<a href='https://fcrbuw.coding.io/?p=24'>身份证开发包兼容机器说明</a></p>
<p>   1.4 <a href='https://fcrbuw.coding.io/?p=24'>下载地址</a></p>
<h3>2. 二次开发说明</h3>
<h4>2.1 Android Studio工程配置说明</h4>
<ul>
<li>1.添加开发包aar到项目libs目录下</li>
<li>2.配置Moudle的build.gradle,参考如下:</li>

</ul>
<pre><code>...
 android {
     ...
     defaultConfig {
         ...
         targetSdkVersion 22 //身份证功能必须降22，其他无所谓
         ...
     }
     ...
 }
 //2.必须2
 repositories {
     flatDir {
         dirs &#39;libs&#39;   // aar目录
     }
 }

 dependencies {
     ...
    //串口开发包
    //SerialPort SDK
    compile(name: &#39;serialport_sdk_20190429&#39;, ext: &#39;aar&#39;)

    //身份证开发包,需要依赖串口开发包
    //IDcard SDK,need SerialPort SDK
    compile(name: &#39;idcard_sdk_20190429&#39;, ext: &#39;aar&#39;)

 }
</code></pre>
<h4>2.2  接口说明</h4>
<p>身份证类: AsyncParseSFZ</p>
<figure><table>
<thead>
<tr><th>API接口</th><th>接口说明</th></tr></thead>
<tbody><tr><td>AsyncParseSFZ(getMainLooper(), Context);</td><td>构造函数</td></tr><tr><td>openIDCardSerialPort()</td><td>打开身份证串口</td></tr><tr><td>closeIDCardSerialPort()</td><td>关闭身份证串口</td></tr><tr><td>readSFZ()</td><td>读身份证</td></tr><tr><td>setOnReadSFZListener(OnReadSFZListener)</td><td>读身份证结果监听回调</td></tr></tbody>
</table></figure>
<p>具体说明:</p>
<ul>
<li>AsyncParseSFZ()</li>
<li>openIDCardSerialPort()</li>
<li>readSFZ()</li>
<li>setOnReadSFZListener(OnReadSFZListener)</li>
<li>closeIDCardSerialPort()</li>

</ul>
<h4>2.3 接口调用流程</h4>
<pre><code class='language-mermaid' lang='mermaid'>
graph TB
  A[AsyncParseSFZ api = new AsyncParseSFZ:实例化]--&gt;B[api.openIDCardSerialPort:打开串口]
  B--&gt;C[api.readSFZ:读身份证]
  C--&gt;D[api.closeIDCardSerialPort:关闭串口]
  
  B--&gt;E[api.setsetOnReadSFZListener监听结果回调]



</code></pre>
<p>&nbsp;</p>
<h4>2.4 接口调用案例</h4>
<pre><code class='language-java' lang='java'>import com.cw.demo.utils.BaseUtils;
import com.cw.demo.R;
import com.cw.idcardsdk.AsyncParseSFZ;
import com.cw.idcardsdk.ParseSFZAPI;
import com.cw.serialportsdk.CoreWise;
import com.cw.serialportsdk.utils.DataUtils;

import android_serialport_api.SerialPortManager;

public class IDCardActivity extends AppCompatActivity {

    @SuppressLint(&quot;WrongConstant&quot;)
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
  
       	//1.第一步：实例化
        asyncParseSFZ = new AsyncParseSFZ(getMainLooper(), this);
		//2.第二步：设置读卡监听回调接口,
        //该读卡回调接口需要在合适的地方调用        asyncParseSFZ.readSFZ();  
        asyncParseSFZ.setOnReadSFZListener(new AsyncParseSFZ.OnReadSFZListener() {
            @Override
            public void onReadSuccess(ParseSFZAPI.People people) {
                 //读卡成功
            }
            @Override
            public void onReadFail(int confirmationCode) {
				//读卡失败
            }
        });
    }
    @Override
    protected void onResume() {
        super.onResume();
        //2.打开身份证串口
        asyncParseSFZ.openIDCardSerialPort();
    }
    @Override
    protected void onPause() {
        super.onPause();
        //最后一步：关闭身份证串口
        asyncParseSFZ.closeIDCardSerialPort(); 
    }
}


</code></pre>
<p>&nbsp;</p>
</body>
</html>